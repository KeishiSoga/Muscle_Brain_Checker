<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è„³ç­‹æœ€å¼·ç¿’æ…£ã‚¢ãƒ—ãƒª</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ã‚¹ã‚¿ã‚¤ãƒ«ã¯å‰å›ã¨åŒã˜ã‚‚ã®ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€ä¿å­˜ãƒœã‚¿ãƒ³é–¢é€£ã‚’å‰Šé™¤ */
        :root {
            --primary-color: #FF4B4B;
            --muscle-bg: #FFF5F5;
            --accent-color: #FFD700;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--muscle-bg);
            margin: 0;
            padding: 0;
            color: #333;
            text-align: center;
            padding-bottom: 50px;
            transition: background-color 0.5s ease;
        }

        /* ç”»é¢æŒ¯å‹•ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes shake {
            0%, 100% { transform: translate(0, 0); }
            10% { transform: translate(-2px, -2px); }
            20% { transform: translate(2px, 2px); }
            30% { transform: translate(-2px, 2px); }
            40% { transform: translate(2px, -2px); }
            50% { transform: translate(-1px, -1px); }
            60% { transform: translate(1px, 1px); }
            70% { transform: translate(-1px, 1px); }
            80% { transform: translate(1px, -1px); }
            90% { transform: translate(0, 0); }
        }

        body.shake {
            animation: shake 0.3s ease;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        .catchphrase {
            font-family: 'Noto Serif JP', serif;
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 15px;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            line-height: 1.6;
        }

        .subtitle {
            font-family: 'Noto Sans JP', sans-serif;
            color: #666;
            font-size: 1rem;
            margin-bottom: 30px;
            font-weight: 700;
            letter-spacing: 0.05em;
            line-height: 1.6;
        }

        .progress-container {
            background: #ddd;
            border-radius: 20px;
            height: 30px;
            width: 100%;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }

        .progress-bar {
            background: linear-gradient(90deg, #FF4B4B, #FF8E53);
            height: 100%;
            width: 0%;
            transition: width 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
            position: relative;
            overflow: visible;
        }

        /* ãƒ‘ãƒ³ãƒ—ã‚¢ãƒƒãƒ—ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes pump {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.15); }
        }

        .progress-bar.pumping {
            animation: pump 0.5s ease infinite;
        }

        /* 100%æ™‚ã®é‡‘è‰²ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .progress-bar.golden {
            background: linear-gradient(90deg, #FFD700, #FFA500, #FFD700);
            background-size: 200% 100%;
            animation: goldenShine 1.5s ease infinite, pump 0.5s ease infinite;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.6);
        }

        @keyframes goldenShine {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* ç‚ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .progress-bar::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.3), transparent);
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .progress-bar.golden::before {
            opacity: 1;
            animation: flame 0.6s ease infinite;
        }

        @keyframes flame {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.5; }
            25% { transform: scale(1.1) rotate(-2deg); opacity: 0.7; }
            50% { transform: scale(1.05) rotate(2deg); opacity: 0.6; }
            75% { transform: scale(1.1) rotate(-1deg); opacity: 0.7; }
        }

        .check-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }

        .check-card {
            background: white;
            border: 3px solid #eee;
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            text-align: left;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            user-select: none; /* é€£æ‰“ã—ã¦ã‚‚æ–‡å­—é¸æŠã•ã‚Œãªã„ã‚ˆã†ã« */
        }

        .check-card input[type="checkbox"] {
            display: none;
        }

        .check-card:has(input:checked) {
            border-color: var(--primary-color);
            background-color: #FFF0F0;
            transform: scale(1.02);
            box-shadow: 0 8px 15px rgba(255, 75, 75, 0.2);
        }

        .check-card:has(input:checked)::after {
            content: "ğŸ’ª";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
        }

        .check-title {
            display: block;
            font-weight: 900;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .check-sub {
            font-size: 0.85rem;
            color: #666;
        }

        .result-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            border: 4px solid var(--accent-color);
            display: none;
        }
        
        .result-section.active {
            display: block;
            animation: popUp 0.5s ease;
        }

        @keyframes popUp {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }



        .book-link-section {
            margin-top: 40px;
            opacity: 0.9;
        }
        .book-cover-image {
            max-width: 150px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border-radius: 5px;
            transition: transform 0.3s;
        }
        .book-cover-image:hover {
            transform: rotate(-2deg) scale(1.05);
        }

        /* ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ */
        .share-section {
            margin-top: 20px;
            text-align: center;
        }

        .share-btn {
            background: linear-gradient(135deg, #1DA1F2, #0d8bd9);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(29, 161, 242, 0.3);
            font-family: 'Noto Sans JP', sans-serif;
        }

        .share-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(29, 161, 242, 0.5);
            background: linear-gradient(135deg, #0d8bd9, #1DA1F2);
        }

        .share-btn:active {
            transform: scale(0.98);
        }

        /* é£›ã³å‡ºã™ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .popup-text {
            position: fixed;
            pointer-events: none;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 900;
            font-size: 1.5rem;
            color: var(--primary-color);
            z-index: 10000;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            animation: popupFly 1s ease-out forwards;
        }

        @keyframes popupFly {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0.5);
            }
            50% {
                opacity: 1;
                transform: translate(-50%, calc(-50% - 50px)) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, calc(-50% - 100px)) scale(0.8);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="catchphrase">è„³ç­‹æœ€å¼·ã®æ–°ç¿’æ…£</h1>
            <p class="subtitle">ç¾çŠ¶ç¶­æŒã¯é€€åŒ–ã ï¼æ˜¨æ—¥ã‚ˆã‚Šã‚‚æˆé•·ã—ã‚ˆã†ï¼</p>
        </header>

        <main>
            <div class="progress-container">
                <div class="progress-bar" id="muscleGauge">0%</div>
            </div>

            <form id="checkForm">
                <div class="check-grid">
                    <label class="check-card" onclick="handleCardClick(event)">
                        <input type="checkbox" name="exercise" value="true" onchange="updateUI()">
                        <span class="check-title"> é‹å‹•ã—ã¾ã—ãŸã‹ï¼Ÿ</span>
                        <span class="check-sub">ã¾ãšã¯5åˆ†ã®é‹å‹•ã‹ã‚‰ï¼ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆã§ã‚‚OKï¼</span>
                    </label>

                    <label class="check-card" onclick="handleCardClick(event)">
                        <input type="checkbox" name="study" value="true" onchange="updateUI()">
                        <span class="check-title"> è„³ã‚’é›ãˆã¾ã—ãŸã‹ï¼Ÿ</span>
                        <span class="check-sub">èª­æ›¸ãƒ»å‹‰å¼·ã€5åˆ†ã§æ˜¨æ—¥ã®è‡ªåˆ†ã‚’è¶…ãˆã‚ï¼</span>
                    </label>

                    <label class="check-card" onclick="handleCardClick(event)">
                        <input type="checkbox" name="challenge" value="true" onchange="updateUI()">
                        <span class="check-title"> æ–°ã—ã„æŒ‘æˆ¦ã‚’ã—ã¾ã—ãŸã‹ï¼Ÿ</span>
                        <span class="check-sub">æ–°ã—ã„æŒ‘æˆ¦ã«ãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã‚ˆã†ï¼</span>
                    </label>

                    <label class="check-card" onclick="handleCardClick(event)">
                        <input type="checkbox" name="smile" value="true" onchange="updateUI()">
                        <span class="check-title"> å‘¨ã‚Šã‚’ç¬‘é¡”ã«ã—ã¾ã—ãŸã‹ï¼Ÿ</span>
                        <span class="check-sub">æŒ¨æ‹¶ã€æ„Ÿè¬ã€ãƒ¦ãƒ¼ãƒ¢ã‚¢ï¼ç­‹è‚‰ã¨ç¬‘é¡”ãŒæœ€å¼·ã®æ­¦å™¨ï¼</span>
                    </label>

                    <label class="check-card" onclick="handleCardClick(event)">
                        <input type="checkbox" name="criticism" value="true" onchange="updateUI()">
                        <span class="check-title"> æ‰¹åˆ¤ã‚’å·¦ã‹ã‚‰å³ã«å—ã‘æµã—ã¾ã—ãŸã‹ï¼Ÿ</span>
                        <span class="check-sub">ãƒã‚¬ãƒ†ã‚£ãƒ–ãªè¨€è‘‰ã¯èãæµã—ã¦ã€è‡ªåˆ†ã®é“ã‚’é€²ã‚ï¼ç­‹è‚‰ã¯å‰é€²ã™ã‚‹ï¼</span>
                    </label>
                </div>
            </form>

            <div id="dynamicMessage" class="result-section">
                <h2 id="msgTitle"></h2>
                <p id="msgBody"></p>
            </div>

            <div class="share-section" style="display: none;" id="shareSection">
                <button onclick="shareToX()" class="share-btn">
                    ç­‹è‚‰ã¨è„³ã®æˆé•·ã‚’Xã§å«ã¶ ğŸ“¢
                </button>
            </div>

            <div class="book-link-section">
                <p style="font-weight:bold;">ï¼¼æœ€å¼·ã®ãƒã‚¤ãƒ–ãƒ«ï¼</p>
                <a href="https://amzn.asia/d/dixGHZO" target="_blank">
                    <img src="{{ url_for('static', filename='è¡¨ç´™.png') }}" alt="è„³ç­‹æœ¬" class="book-cover-image">
                </a>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', updateUI);

        // é£›ã³å‡ºã™ãƒ†ã‚­ã‚¹ãƒˆã®é…åˆ—
        const popupTexts = ['NICE BULK!', 'LIGHT WEIGHT!', 'YEAH!', 'ğŸ’ª', 'POWER UP!', 'BEAST MODE!'];

        // ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†ï¼ˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”¨ï¼‰
        function handleCardClick(event) {
            // ç”»é¢æŒ¯å‹•
            document.body.classList.add('shake');
            setTimeout(() => {
                document.body.classList.remove('shake');
            }, 300);

            // ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã«é£›ã³å‡ºã™ãƒ†ã‚­ã‚¹ãƒˆ
            const popupText = popupTexts[Math.floor(Math.random() * popupTexts.length)];
            createPopupText(event.clientX, event.clientY, popupText);
        }

        // é£›ã³å‡ºã™ãƒ†ã‚­ã‚¹ãƒˆã‚’ä½œæˆ
        function createPopupText(x, y, text) {
            const popup = document.createElement('div');
            popup.className = 'popup-text';
            popup.textContent = text;
            popup.style.left = x + 'px';
            popup.style.top = y + 'px';
            popup.style.transform = 'translate(-50%, -50%)';
            document.body.appendChild(popup);

            setTimeout(() => {
                popup.remove();
            }, 1000);
        }

        // èƒŒæ™¯è‰²ã‚’é”æˆåº¦ã«å¿œã˜ã¦å¤‰æ›´
        function updateBackgroundColor(percentage) {
            const body = document.body;
            if (percentage === 100) {
                // 100%: ã‚´ãƒ¼ãƒ«ãƒ‰ï¼ˆã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚µã‚¤ãƒ¤äººé¢¨ï¼‰
                body.style.backgroundColor = '#FFE5B4';
            } else if (percentage >= 80) {
                // 80%ä»¥ä¸Š: æ¿ƒã„èµ¤ï¼ˆè¡€æµã‚¢ãƒƒãƒ—ï¼‰
                body.style.backgroundColor = '#FFE0E0';
            } else if (percentage >= 60) {
                // 60%ä»¥ä¸Š: ã‚„ã‚„æ¿ƒã„ãƒ”ãƒ³ã‚¯
                body.style.backgroundColor = '#FFEBEB';
            } else if (percentage >= 40) {
                // 40%ä»¥ä¸Š: ä¸­ç¨‹åº¦ã®ãƒ”ãƒ³ã‚¯
                body.style.backgroundColor = '#FFF0F0';
            } else {
                // 40%æœªæº€: è–„ã„ãƒ”ãƒ³ã‚¯ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
                body.style.backgroundColor = '#FFF5F5';
            }
        }

        function updateUI() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const total = checkboxes.length;
            const percentage = (checkedCount / total) * 100;

            // ã‚²ãƒ¼ã‚¸æ›´æ–°
            const gauge = document.getElementById('muscleGauge');
            gauge.style.width = percentage + '%';
            gauge.textContent = `è„³ç­‹ãƒ‘ãƒ¯ãƒ¼ ${Math.round(percentage)}%`;

            // ãƒ‘ãƒ³ãƒ—ã‚¢ãƒƒãƒ—ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            if (percentage > 0 && percentage < 100) {
                gauge.classList.add('pumping');
            } else {
                gauge.classList.remove('pumping');
            }

            // 100%æ™‚ã®é‡‘è‰²ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
            if (percentage === 100) {
                gauge.classList.add('golden');
            } else {
                gauge.classList.remove('golden');
            }

            // èƒŒæ™¯è‰²æ›´æ–°
            updateBackgroundColor(percentage);

            // ã‚·ã‚§ã‚¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡ï¼ˆé”æˆåº¦ãŒé«˜ã„æ™‚ã®ã¿è¡¨ç¤ºï¼‰
            const shareSection = document.getElementById('shareSection');
            if (percentage >= 80 || checkedCount >= 4) {
                shareSection.style.display = 'block';
            } else {
                shareSection.style.display = 'none';
            }

            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ›´æ–°
            const msgArea = document.getElementById('dynamicMessage');
            const msgTitle = document.getElementById('msgTitle');
            const msgBody = document.getElementById('msgBody');

            let title, body;

            if (checkedCount > 0) {
                msgArea.classList.add('active');
            } else {
                msgArea.classList.remove('active');
            }

            // ãƒ†ã‚­ã‚¹ãƒˆåˆ†å²
            switch(checkedCount) {
                case 5:
                    title = "å®Œå…¨åˆ¶è¦‡ï¼æœ€å¼·ã®è„³ç­‹ãƒã‚¹ã‚¿ãƒ¼ï¼";
                    body = "å…¨ã¦ã‚’ã‚¯ãƒªã‚¢ã—ãŸï¼å›ã¯çœŸã®è„³ç­‹æˆ¦å£«ã ï¼ä¸–ç•ŒãŒå›ã®ç­‹è‚‰ã«éœ‡ãˆã‚‹ï¼";
                    confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
                    break;
                case 4:
                    title = "æœ€å¼·ï¼ä»Šæ—¥ã®ã‚ãªãŸã¯æœ€å¼·ã®è„³ç­‹ã ï¼";
                    body = "ç­‹è‚‰ã‚‚è„³ã‚‚çµ¶å¥½èª¿ï¼å›ã®ç­‹è‚‰ã§ä¸–ç•ŒãŒæ˜ã‚‹ããªã‚‹ï¼";
                    confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                    break;
                case 3:
                    title = "ã‚ã¨ä¸€æ­©ï¼ã»ã¼æœ€å¼·ã®è„³ç­‹ã ï¼";
                    body = "ç´ æ™´ã‚‰ã—ã„æˆæœï¼æ˜æ—¥ã¯å®Œå…¨åˆ¶è¦‡ã‚’ç‹™ãŠã†ï¼";
                    break;
                case 2:
                    title = "åŠåˆ†ã‚¯ãƒªã‚¢ï¼ååˆ†ãƒŠã‚¤ã‚¹è„³ç­‹ï¼";
                    body = "ç¶™ç¶šã“ãåŠ›ãªã‚Šï¼å›ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¯ã¾ã ã¾ã ã“ã‚“ãªã‚‚ã‚“ã˜ã‚ƒãªã„ï¼";
                    break;
                case 1:
                    title = "æœ€åˆã®ä¸€æ­©ï¼ãã‚ŒãŒä¸€ç•ªå¤§äº‹ï¼";
                    body = "0ã¨1ã®å·®ã¯ç„¡é™å¤§ï¼ä»Šæ—¥å‹•ã„ãŸè‡ªåˆ†ã‚’è¤’ã‚ã¡ãã‚Œï¼";
                    break;
                default:
                    title = ""; body = "";
            }

            if (checkedCount > 0) {
                msgTitle.textContent = title;
                msgBody.textContent = body;
            }
        }

        // Xï¼ˆæ—§Twitterï¼‰ã¸ã®ã‚·ã‚§ã‚¢æ©Ÿèƒ½
        function shareToX() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const total = checkboxes.length;
            const percentage = Math.round((checkedCount / total) * 100);

            let shareText = '';
            if (percentage === 100) {
                shareText = 'å®Œå…¨åˆ¶è¦‡ï¼ä»Šæ—¥ã¯è„³ç­‹ãƒ‘ãƒ¯ãƒ¼100%é”æˆï¼ğŸ’ª\n\n#è„³ç­‹æœ€å¼·';
            } else if (percentage >= 80) {
                shareText = `è„³ç­‹ãƒ‘ãƒ¯ãƒ¼${percentage}%é”æˆï¼ã‚ã¨å°‘ã—ã§å®Œå…¨åˆ¶è¦‡ï¼ğŸ’ª\n\n#è„³ç­‹æœ€å¼·`;
            } else {
                shareText = `ä»Šæ—¥ã‚‚è„³ç­‹ãƒ‘ãƒ¯ãƒ¼${percentage}%é”æˆï¼ç¶™ç¶šã“ãåŠ›ãªã‚Šï¼ğŸ’ª\n\n#è„³ç­‹æœ€å¼·`;
            }

            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent(shareText);
            const shareUrl = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
            
            window.open(shareUrl, '_blank', 'width=550,height=420');
        }
    </script>
</body>
</html>